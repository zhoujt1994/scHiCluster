

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>hicluster prepare-impute &#8212; scHiCluster</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-codeautolink.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'command_line/hicluster_prepare_impute';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="hicluster contact-distance" href="hicluster_contact_distance.html" />
    <link rel="prev" title="hicluster filter-contact" href="hicluster_filter_contact.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    <p class="title logo__title">scHiCluster</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    scHiCluster
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Tan2021/intro.html">Tan et al. Cell 2021.</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Tan2021/imputation.html">Prepare and run imputation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tan2021/rna_clustering.html">scRNA(MALBAC) clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tan2021/dipc_clustering.html">DipC clustering at 100kb resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tan2021/rna_3c_integrate.html">Assign DipC cells to RNA clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tan2021/prepare.html">Prepare pseudobulk analyses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Tan2021/loop_blacklist.html">Generate blacklist for loop calling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../hba/intro.html">Human Brain Atlas</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../hba/rna_majortype/intro.html">Differentially expressed genes</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../hba/rna_majortype/01.deg.html">DEG identification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/rna_majortype/02.loop_corr.html">RNA correlated loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/rna_majortype/03.domain_corr.html">RNA correlated boundary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/rna_majortype/04.comp_corr.html">RNA correlated compartment</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../hba/loop_majortype/intro.html">Differential loops</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../hba/loop_majortype/01.diff.html">ANOVA of loop matrices across cell types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/loop_majortype/02.load.html">Load loop matrices and stats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/loop_majortype/03.apa.html">Aggregate peak analysis of differential loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/loop_majortype/04.corr.html">Correlation between loop and other modalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/loop_majortype/05.plot.html">Plot correlation between loop and mC/ATAC/RNA</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../hba/domain_majortype/intro.html">Differential domain boundaries</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../hba/domain_majortype/01.call.html">Domain boundary prob</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/domain_majortype/02.count.html">Domain count and size</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/domain_majortype/03.diff.html">Differential boundary</a></li>

<li class="toctree-l3"><a class="reference internal" href="../hba/domain_majortype/04.corr.html">Correlation between boundary and other modalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/domain_majortype/05.plot.html">Plot correlation between boundary and mC/ATAC/RNA</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../hba/compartment_majortype/intro.html">Differential compartments</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../hba/compartment_majortype/01.call.html">Call compartment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/compartment_majortype/02.comC.html">Compare compartment with comethylation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/compartment_majortype/03.example.html">Plot example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/compartment_majortype/04.diff.html">Differential compartment calling with dcHiC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/compartment_majortype/05.corr.html">Correlation between compartment and other modalities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hba/compartment_majortype/06.plot.html">Plot correlation between compartment and mC/ATAC/RNA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../hba/correlation_summary.html">Correlation Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hba/plot_example.html">Plot examples</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COMMAND LINE TOOLS</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="hicluster_filter_contact.html">hicluster filter-contact</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">hicluster prepare-impute</a></li>
<li class="toctree-l1"><a class="reference internal" href="hicluster_contact_distance.html">hicluster contact-distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="hicluster_embedding.html">hicluster embedding</a></li>
<li class="toctree-l1"><a class="reference internal" href="hicluster_cpg_ratio.html">hicluster cpg-ratio</a></li>
<li class="toctree-l1"><a class="reference internal" href="hicluster_compartment.html">hicluster compartment</a></li>
<li class="toctree-l1"><a class="reference internal" href="hicluster_domain.html">hicluster domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="hicluster_gene_score.html">hicluster gene-score</a></li>
<li class="toctree-l1"><a class="reference internal" href="hicluster_merge_cell_raw.html">hicluster merge-cell-raw</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/zhoujt1994/scHiCluster" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/zhoujt1994/scHiCluster/issues/new?title=Issue%20on%20page%20%2Fcommand_line/hicluster_prepare_impute.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/command_line/hicluster_prepare_impute.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>hicluster prepare-impute</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#command-docs">Command Docs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eaxmple-1-imputation-at-100kb-resolution">Eaxmple 1: Imputation at 100kb resolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eaxmple-2-imputation-at-25kb-resolution">Eaxmple 2: Imputation at 25kb resolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eaxmple-3-imputation-at-10kb-resolution">Eaxmple 3: Imputation at 10kb resolution</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hicluster-prepare-impute">
<h1>hicluster prepare-impute<a class="headerlink" href="#hicluster-prepare-impute" title="Permalink to this heading">#</a></h1>
<p>After removing the blacklist regions, the following command will generate a file called “snakemake_cmd.txt”. Each line in this file represents a Snakemake command for running imputation with specific parameters for a certain number of cells (batch_size). By appending each line to your job submission template, you can parallelize the imputation process between batches. The parallelization within each batch, handling multiple cells, will be managed by Snakemake on a single node.</p>
<p>The choice of batch_size should be based on the settings of your supercomputer. Previsou benchmark indicate that, jobs executed on nodes with 96 CPUs per node. We assign 1536 cells to each job in order to strike a balance and avoid creating an excessive number of jobs, which could result in long queue times.</p>
<section id="command-docs">
<h2>Command Docs<a class="headerlink" href="#command-docs" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>usage:<span class="w"> </span>hicluster<span class="w"> </span>prepare-impute<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span>--output_dir<span class="w"> </span>OUTPUT_DIR<span class="w"> </span>--chrom_size_path
<span class="w">                                </span>CHROM_SIZE_PATH<span class="w"> </span>--output_dist<span class="w"> </span>OUTPUT_DIST
<span class="w">                                </span>--window_size<span class="w"> </span>WINDOW_SIZE<span class="w"> </span>--step_size
<span class="w">                                </span>STEP_SIZE<span class="w"> </span>--resolution<span class="w"> </span>RESOLUTION
<span class="w">                                </span><span class="o">[</span>--input_scool<span class="w"> </span>INPUT_SCOOL<span class="o">]</span>
<span class="w">                                </span><span class="o">[</span>--cell_table<span class="w"> </span>CELL_TABLE<span class="o">]</span>
<span class="w">                                </span><span class="o">[</span>--batch_size<span class="w"> </span>BATCH_SIZE<span class="o">]</span><span class="w"> </span><span class="o">[</span>--logscale<span class="o">]</span>
<span class="w">                                </span><span class="o">[</span>--pad<span class="w"> </span>PAD<span class="o">]</span><span class="w"> </span><span class="o">[</span>--std<span class="w"> </span>STD<span class="o">]</span><span class="w"> </span><span class="o">[</span>--rp<span class="w"> </span>RP<span class="o">]</span><span class="w"> </span><span class="o">[</span>--tol<span class="w"> </span>TOL<span class="o">]</span>
<span class="w">                                </span><span class="o">[</span>--min_cutoff<span class="w"> </span>MIN_CUTOFF<span class="o">]</span>
<span class="w">                                </span><span class="o">[</span>--cpu_per_job<span class="w"> </span>CPU_PER_JOB<span class="o">]</span><span class="w"> </span><span class="o">[</span>--chr1<span class="w"> </span>CHROM1<span class="o">]</span>
<span class="w">                                </span><span class="o">[</span>--chr2<span class="w"> </span>CHROM2<span class="o">]</span><span class="w"> </span><span class="o">[</span>--pos1<span class="w"> </span>POS1<span class="o">]</span><span class="w"> </span><span class="o">[</span>--pos2<span class="w"> </span>POS2<span class="o">]</span>

optional<span class="w"> </span>arguments:
<span class="w">  </span>-h,<span class="w"> </span>--help<span class="w">            </span>show<span class="w"> </span>this<span class="w"> </span><span class="nb">help</span><span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span><span class="nb">exit</span>
<span class="w">  </span>--input_scool<span class="w"> </span>INPUT_SCOOL
<span class="w">                        </span>Path<span class="w"> </span>to<span class="w"> </span>input<span class="w"> </span>scool<span class="w"> </span>file<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span>None<span class="o">)</span>
<span class="w">  </span>--cell_table<span class="w"> </span>CELL_TABLE
<span class="w">                        </span>Contain<span class="w"> </span>all<span class="w"> </span>the<span class="w"> </span>cell<span class="w"> </span>contact<span class="w"> </span>file<span class="w"> </span>after<span class="w"> </span>blacklist
<span class="w">                        </span>removalin<span class="w"> </span>two<span class="w"> </span>tab-separated<span class="w"> </span>columns:<span class="w"> </span><span class="m">1</span>.<span class="w"> </span>cell_uid,<span class="w"> </span><span class="m">2</span>.
<span class="w">                        </span>file_path.No<span class="w"> </span>header<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span>None<span class="o">)</span>
<span class="w">  </span>--batch_size<span class="w"> </span>BATCH_SIZE
<span class="w">                        </span>Number<span class="w"> </span>of<span class="w"> </span>cells<span class="w"> </span>to<span class="w"> </span>include<span class="w"> </span><span class="k">in</span><span class="w"> </span>each<span class="w"> </span>batch<span class="w"> </span>run<span class="w"> </span><span class="o">(</span>default:
<span class="w">                        </span><span class="m">100</span><span class="o">)</span>
<span class="w">  </span>--logscale
<span class="w">  </span>--pad<span class="w"> </span>PAD
<span class="w">  </span>--std<span class="w"> </span>STD
<span class="w">  </span>--rp<span class="w"> </span>RP
<span class="w">  </span>--tol<span class="w"> </span>TOL
<span class="w">  </span>--min_cutoff<span class="w"> </span>MIN_CUTOFF
<span class="w">  </span>--cpu_per_job<span class="w"> </span>CPU_PER_JOB
<span class="w">                        </span>Number<span class="w"> </span>of<span class="w"> </span>cpus<span class="w"> </span>to<span class="w"> </span>parallel.<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">10</span><span class="o">)</span>
<span class="w">  </span>--chr1<span class="w"> </span>CHROM1<span class="w">         </span><span class="m">0</span><span class="w"> </span>based<span class="w"> </span>index<span class="w"> </span>of<span class="w"> </span>chr1<span class="w"> </span>column.<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">1</span><span class="o">)</span>
<span class="w">  </span>--chr2<span class="w"> </span>CHROM2<span class="w">         </span><span class="m">0</span><span class="w"> </span>based<span class="w"> </span>index<span class="w"> </span>of<span class="w"> </span>chr2<span class="w"> </span>column.<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">5</span><span class="o">)</span>
<span class="w">  </span>--pos1<span class="w"> </span>POS1<span class="w">           </span><span class="m">0</span><span class="w"> </span>based<span class="w"> </span>index<span class="w"> </span>of<span class="w"> </span>pos1<span class="w"> </span>column.<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">2</span><span class="o">)</span>
<span class="w">  </span>--pos2<span class="w"> </span>POS2<span class="w">           </span><span class="m">0</span><span class="w"> </span>based<span class="w"> </span>index<span class="w"> </span>of<span class="w"> </span>pos2<span class="w"> </span>column.<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">6</span><span class="o">)</span>

required<span class="w"> </span>arguments:
<span class="w">  </span>--output_dir<span class="w"> </span>OUTPUT_DIR
<span class="w">                        </span>Path<span class="w"> </span>to<span class="w"> </span>output<span class="w"> </span>directory<span class="w"> </span>containing<span class="w"> </span>the<span class="w"> </span>single-cell
<span class="w">                        </span>cool<span class="w"> </span>files<span class="w"> </span>after<span class="w"> </span>imputation<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span>None<span class="o">)</span>
<span class="w">  </span>--chrom_size_path<span class="w"> </span>CHROM_SIZE_PATH
<span class="w">                        </span>Path<span class="w"> </span>to<span class="w"> </span>UCSC<span class="w"> </span>chrom<span class="w"> </span>size<span class="w"> </span>fileContain<span class="w"> </span>all<span class="w"> </span>the<span class="w"> </span>chromosome
<span class="w">                        </span>information<span class="w"> </span><span class="k">in</span><span class="w"> </span>two<span class="w"> </span>tab-separated<span class="w"> </span>columns:<span class="w"> </span><span class="m">1</span>.
<span class="w">                        </span>chromosome<span class="w"> </span>name,<span class="w"> </span><span class="m">2</span>.<span class="w"> </span>chromosome<span class="w"> </span>length.<span class="w"> </span>No<span class="w"> </span>header
<span class="w">                        </span><span class="o">(</span>default:<span class="w"> </span>None<span class="o">)</span>
<span class="w">  </span>--output_dist<span class="w"> </span>OUTPUT_DIST
<span class="w">                        </span>Maximum<span class="w"> </span>distance<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>contact<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>written<span class="w"> </span>to<span class="w"> </span>the
<span class="w">                        </span>output<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">500000000</span><span class="o">)</span>
<span class="w">  </span>--window_size<span class="w"> </span>WINDOW_SIZE
<span class="w">                        </span>The<span class="w"> </span>size<span class="w"> </span><span class="k">in</span><span class="w"> </span>base<span class="w"> </span>pairs<span class="w"> </span>of<span class="w"> </span>sliding<span class="w"> </span>window<span class="w"> </span><span class="k">for</span>
<span class="w">                        </span>imputation<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">500000000</span><span class="o">)</span>
<span class="w">  </span>--step_size<span class="w"> </span>STEP_SIZE
<span class="w">                        </span>The<span class="w"> </span>step<span class="w"> </span>size<span class="w"> </span><span class="k">in</span><span class="w"> </span>base<span class="w"> </span>pairs<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>sliding<span class="w"> </span>window
<span class="w">                        </span>moves<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span><span class="m">10000000</span><span class="o">)</span>
<span class="w">  </span>--resolution<span class="w"> </span>RESOLUTION
<span class="w">                        </span>Resolution<span class="w"> </span><span class="k">for</span><span class="w"> </span>imputation<span class="w"> </span><span class="o">(</span>default:<span class="w"> </span>None<span class="o">)</span>
</pre></div>
</div>
</section>
<section id="eaxmple-1-imputation-at-100kb-resolution">
<h2>Eaxmple 1: Imputation at 100kb resolution<a class="headerlink" href="#eaxmple-1-imputation-at-100kb-resolution" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hicluster<span class="w"> </span>prepare-impute<span class="w"> </span>
<span class="w">    </span>--cell_table<span class="w"> </span>contact_table_rmbkl.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--batch_size<span class="w"> </span><span class="m">1536</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pad<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cpu_per_job<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--chr1<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pos1<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--chr2<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pos2<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output_dir<span class="w"> </span>impute/100K/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--chrom_size_path<span class="w"> </span>/data/aging/ref/m3C/mm10.main.nochrM.nochrY.chrom.sizes<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output_dist<span class="w"> </span><span class="m">500000000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--window_size<span class="w"> </span><span class="m">500000000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--step_size<span class="w"> </span><span class="m">500000000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--resolution<span class="w"> </span><span class="m">100000</span><span class="w"> </span><span class="se">\</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--cell_table<span class="w"> </span>contact_table_rmbkl.tsv
</pre></div>
</div>
<p>Specify the file paths of the contact files after removing blacklist regions in this line(e.g. /home/qzeng_salk_edu/project/aging/230711_m3C/rmbkl/AMB_220712_18mo_12D_13B_2_P4-1-I15-K1.contact.rmbkl.tsv.gz). Here is an example of what the contact_table_rmbkl.tsv looks like</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cell_1<span class="w"> </span>absolute_hic_rmbkl_contact_path_1
cell_2<span class="w"> </span>absolute_hic_rmbkl_contact_path_2
cell_3<span class="w"> </span>absolute_hic_rmbkl_contact_path_3
</pre></div>
</div>
<p>The first column indicates the cell name (e.g. AMB_220712_18mo_12D_13B_2_P4-1-I15-K1) whereas the second column indicates the HiC contact file path after removing blacklist of the cell. Make sure the two parts are separated by a tab; also make sure the file has no header.</p>
<p>You don’t need to create the folder before running.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--output_dir<span class="w"> </span>impute/100K/
</pre></div>
</div>
<p>After running the above command, we get a file names snakemake_cmd.txt. Run the command to get imputed cool files at 100kb resolution :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash<span class="w"> </span>/home/qzeng_salk_edu/project/aging/230711_m3C/impute/100K/snakemake_cmd.txt<span class="w"> </span>
</pre></div>
</div>
</section>
<section id="eaxmple-2-imputation-at-25kb-resolution">
<h2>Eaxmple 2: Imputation at 25kb resolution<a class="headerlink" href="#eaxmple-2-imputation-at-25kb-resolution" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hicluster<span class="w"> </span>prepare-impute<span class="w"> </span>
<span class="w">    </span>--cell_table<span class="w"> </span>contact_table_rmbkl.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--batch_size<span class="w"> </span><span class="m">1536</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pad<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cpu_per_job<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--chr1<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pos1<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--chr2<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pos2<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output_dir<span class="w"> </span>impute/100K/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--chrom_size_path<span class="w"> </span>/data/aging/ref/m3C/mm10.main.nochrM.nochrY.chrom.sizes<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output_dist<span class="w"> </span><span class="m">5050000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--window_size<span class="w"> </span><span class="m">500000000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--step_size<span class="w"> </span><span class="m">500000000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--resolution<span class="w"> </span><span class="m">25000</span><span class="w"> </span><span class="se">\</span>
</pre></div>
</div>
</section>
<section id="eaxmple-3-imputation-at-10kb-resolution">
<h2>Eaxmple 3: Imputation at 10kb resolution<a class="headerlink" href="#eaxmple-3-imputation-at-10kb-resolution" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hicluster<span class="w"> </span>prepare-impute<span class="w"> </span>
<span class="w">    </span>--cell_table<span class="w"> </span>contact_table_rmbkl.tsv<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--batch_size<span class="w"> </span><span class="m">1536</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pad<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cpu_per_job<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--chr1<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pos1<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--chr2<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--pos2<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output_dir<span class="w"> </span>impute/100K/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--chrom_size_path<span class="w"> </span>/data/aging/ref/m3C/mm10.main.nochrM.nochrY.chrom.sizes<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output_dist<span class="w"> </span><span class="m">5050000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--window_size<span class="w"> </span><span class="m">30000000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--step_size<span class="w"> </span><span class="m">10000000</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--resolution<span class="w"> </span><span class="m">10000</span><span class="w"> </span><span class="se">\</span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./command_line"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="hicluster_filter_contact.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">hicluster filter-contact</p>
      </div>
    </a>
    <a class="right-next"
       href="hicluster_contact_distance.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">hicluster contact-distance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#command-docs">Command Docs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eaxmple-1-imputation-at-100kb-resolution">Eaxmple 1: Imputation at 100kb resolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eaxmple-2-imputation-at-25kb-resolution">Eaxmple 2: Imputation at 25kb resolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eaxmple-3-imputation-at-10kb-resolution">Eaxmple 3: Imputation at 10kb resolution</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jingtian Zhou
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>